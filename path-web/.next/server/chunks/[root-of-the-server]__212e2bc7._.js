module.exports=[22734,(e,r,i)=>{r.exports=e.x("fs",()=>require("fs"))},98854,e=>{"use strict";var r=e.i(80416);let i=async e=>{let i=await (0,r.loadSharedConfigFiles)(e);return((...e)=>{let r={};for(let i of e)for(let[e,s]of Object.entries(i))void 0!==r[e]?Object.assign(r[e],s):r[e]=s;return r})(i.configFile,i.credentialsFile)};e.s(["parseKnownFiles",0,i],98854)},24868,(e,r,i)=>{r.exports=e.x("fs/promises",()=>require("fs/promises"))},95671,84896,e=>{"use strict";var r=e.i(24868),i=e.i(54799),s=e.i(14747),t=e.i(56729);let o=e=>{let r=(0,i.createHash)("sha1").update(e).digest("hex");return(0,s.join)((0,t.getHomeDir)(),".aws","sso","cache",`${r}.json`)};e.s(["getSSOTokenFilepath",0,o],84896);let n={},a=async e=>{if(n[e])return n[e];let i=o(e);return JSON.parse(await (0,r.readFile)(i,"utf8"))};e.s(["getSSOTokenFromFile",0,a,"tokenIntercept",0,n],95671)},81752,e=>{"use strict";var r=e.i(56433),i=e.i(53008),s=e.i(46238);let t=e=>Object.entries(e).filter(([e])=>e.startsWith(i.IniSectionType.SSO_SESSION+s.CONFIG_PREFIX_SEPARATOR)).reduce((e,[r,i])=>({...e,[r.substring(r.indexOf(s.CONFIG_PREFIX_SEPARATOR)+1)]:i}),{});var o=e.i(74810),n=e.i(46334);let a=()=>({}),l=async(e={})=>(0,n.readFile)(e.configFilepath??(0,r.getConfigFilepath)()).then(o.parseIni).then(t).catch(a);e.s(["loadSsoSessionData",0,l],81752)},35767,e=>{"use strict";var r=e.i(84511);class i extends r.ProviderError{name="TokenProviderError";constructor(e,r=!0){super(e,r),Object.setPrototypeOf(this,i.prototype)}}e.s(["TokenProviderError",()=>i])},73253,e=>{"use strict";var r=e.i(35767),i=e.i(49871),s=e.i(95671),t=e.i(81752),o=e.i(98854);let n="To refresh this SSO session run 'aws sso login' with the corresponding profile.",a=async(r,i={},s)=>{let{SSOOIDCClient:t}=await e.A(49465),o=e=>i.clientConfig?.[e]??i.parentClientConfig?.[e]??s?.[e];return new t(Object.assign({},i.clientConfig??{},{region:r??i.clientConfig?.region,logger:o("logger"),userAgentAppId:o("userAgentAppId")}))},l=async(r,i,s={},t)=>{let{CreateTokenCommand:o}=await e.A(49465);return(await a(i,s,t)).send(new o({clientId:r.clientId,clientSecret:r.clientSecret,refreshToken:r.refreshToken,grantType:"refresh_token"}))},c=e=>{if(e.expiration&&e.expiration.getTime()<Date.now())throw new r.TokenProviderError(`Token is expired. ${n}`,!1)},g=(e,i,s=!1)=>{if(void 0===i)throw new r.TokenProviderError(`Value not present for '${e}' in SSO Token${s?". Cannot refresh":""}. ${n}`,!1)};var f=e.i(84896);let{writeFile:d}=e.i(22734).promises,p=new Date(0);e.s(["fromSso",0,(e={})=>async({callerClientConfig:a}={})=>{let h;e.logger?.debug("@aws-sdk/token-providers - fromSso");let u=await (0,o.parseKnownFiles)(e),w=(0,i.getProfileName)({profile:e.profile??a?.profile}),S=u[w];if(S){if(!S.sso_session)throw new r.TokenProviderError(`Profile '${w}' is missing required property 'sso_session'.`)}else throw new r.TokenProviderError(`Profile '${w}' could not be found in shared credentials file.`,!1);let _=S.sso_session,k=(await (0,t.loadSsoSessionData)(e))[_];if(!k)throw new r.TokenProviderError(`Sso session '${_}' could not be found in shared credentials file.`,!1);for(let e of["sso_start_url","sso_region"])if(!k[e])throw new r.TokenProviderError(`Sso session '${_}' is missing required property '${e}'.`,!1);k.sso_start_url;let C=k.sso_region;try{h=await (0,s.getSSOTokenFromFile)(_)}catch(e){throw new r.TokenProviderError(`The SSO session token associated with profile=${w} was not found or is invalid. ${n}`,!1)}g("accessToken",h.accessToken),g("expiresAt",h.expiresAt);let{accessToken:v,expiresAt:T}=h,m={token:v,expiration:new Date(T)};if(m.expiration.getTime()-Date.now()>3e5)return m;if(Date.now()-p.getTime()<3e4)return c(m),m;g("clientId",h.clientId,!0),g("clientSecret",h.clientSecret,!0),g("refreshToken",h.refreshToken,!0);try{p.setTime(Date.now());let r=await l(h,C,e,a);g("accessToken",r.accessToken),g("expiresIn",r.expiresIn);let i=new Date(Date.now()+1e3*r.expiresIn);try{var O;let e;await (O={...h,accessToken:r.accessToken,expiresAt:i.toISOString(),refreshToken:r.refreshToken},e=(0,f.getSSOTokenFilepath)(_),d(e,JSON.stringify(O,null,2)))}catch(e){}return{token:r.accessToken,expiration:i}}catch(e){return c(m),m}}],73253)},19961,e=>{"use strict";e.s([],33574),e.i(33574);var r=e.i(7401),i=e.i(49871),s=e.i(81752),t=e.i(98854);let o=e=>e&&("string"==typeof e.sso_start_url||"string"==typeof e.sso_account_id||"string"==typeof e.sso_session||"string"==typeof e.sso_region||"string"==typeof e.sso_role_name);e.s(["isSsoProfile",0,o],94047);var n=e.i(80849),a=e.i(73253),l=e.i(95671);let c=async({ssoStartUrl:i,ssoSession:s,ssoAccountId:t,ssoRegion:o,ssoRoleName:c,ssoClient:g,clientConfig:f,parentClientConfig:d,callerClientConfig:p,profile:h,filepath:u,configFilepath:w,ignoreCache:S,logger:_})=>{let k,C,v="To refresh this SSO session run aws sso login with the corresponding profile.";if(s)try{let e=await (0,a.fromSso)({profile:h,filepath:u,configFilepath:w,ignoreCache:S})();k={accessToken:e.token,expiresAt:new Date(e.expiration).toISOString()}}catch(e){throw new r.CredentialsProviderError(e.message,{tryNextLink:!1,logger:_})}else try{k=await (0,l.getSSOTokenFromFile)(i)}catch(e){throw new r.CredentialsProviderError(`The SSO session associated with this profile is invalid. ${v}`,{tryNextLink:!1,logger:_})}if(new Date(k.expiresAt).getTime()-Date.now()<=0)throw new r.CredentialsProviderError(`The SSO session associated with this profile has expired. ${v}`,{tryNextLink:!1,logger:_});let{accessToken:T}=k,{SSOClient:m,GetRoleCredentialsCommand:O}=await e.A(95003),y=g||new m(Object.assign({},f??{},{logger:f?.logger??p?.logger??d?.logger,region:f?.region??o,userAgentAppId:f?.userAgentAppId??p?.userAgentAppId??d?.userAgentAppId}));try{C=await y.send(new O({accountId:t,roleName:c,accessToken:T}))}catch(e){throw new r.CredentialsProviderError(e,{tryNextLink:!1,logger:_})}let{roleCredentials:{accessKeyId:P,secretAccessKey:x,sessionToken:A,expiration:E,credentialScope:I,accountId:F}={}}=C;if(!P||!x||!A||!E)throw new r.CredentialsProviderError("SSO returns an invalid temporary credential.",{tryNextLink:!1,logger:_});let N={accessKeyId:P,secretAccessKey:x,sessionToken:A,expiration:new Date(E),...I&&{credentialScope:I},...F&&{accountId:F}};return s?(0,n.setCredentialFeature)(N,"CREDENTIALS_SSO","s"):(0,n.setCredentialFeature)(N,"CREDENTIALS_SSO_LEGACY","u"),N},g=(e,i)=>{let{sso_start_url:s,sso_account_id:t,sso_region:o,sso_role_name:n}=e;if(!s||!t||!o||!n)throw new r.CredentialsProviderError(`Profile is configured with invalid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Got ${Object.keys(e).join(", ")}
Reference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html`,{tryNextLink:!1,logger:i});return e};e.s(["validateSsoProfile",0,g],15914);let f=(e={})=>async({callerClientConfig:n}={})=>{e.logger?.debug("@aws-sdk/credential-provider-sso - fromSSO");let{ssoStartUrl:a,ssoAccountId:l,ssoRegion:f,ssoRoleName:d,ssoSession:p}=e,{ssoClient:h}=e,u=(0,i.getProfileName)({profile:e.profile??n?.profile});if(a||l||f||d||p)if(a&&l&&f&&d)return c({ssoStartUrl:a,ssoSession:p,ssoAccountId:l,ssoRegion:f,ssoRoleName:d,ssoClient:h,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,callerClientConfig:e.callerClientConfig,profile:u,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger});else throw new r.CredentialsProviderError('Incomplete configuration. The fromSSO() argument hash must include "ssoStartUrl", "ssoAccountId", "ssoRegion", "ssoRoleName"',{tryNextLink:!1,logger:e.logger});{let i=(await (0,t.parseKnownFiles)(e))[u];if(!i)throw new r.CredentialsProviderError(`Profile ${u} was not found.`,{logger:e.logger});if(!o(i))throw new r.CredentialsProviderError(`Profile ${u} is not configured with SSO credentials.`,{logger:e.logger});if(i?.sso_session){let t=(await (0,s.loadSsoSessionData)(e))[i.sso_session],o=` configurations in profile ${u} and sso-session ${i.sso_session}`;if(f&&f!==t.sso_region)throw new r.CredentialsProviderError("Conflicting SSO region"+o,{tryNextLink:!1,logger:e.logger});if(a&&a!==t.sso_start_url)throw new r.CredentialsProviderError("Conflicting SSO start_url"+o,{tryNextLink:!1,logger:e.logger});i.sso_region=t.sso_region,i.sso_start_url=t.sso_start_url}let{sso_start_url:n,sso_account_id:l,sso_region:d,sso_role_name:p,sso_session:w}=g(i,e.logger);return c({ssoStartUrl:n,ssoSession:w,ssoAccountId:l,ssoRegion:d,ssoRoleName:p,ssoClient:h,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,callerClientConfig:e.callerClientConfig,profile:u,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger})}};e.s(["fromSSO",0,f],96265),e.i(96265),e.i(94047),e.s([],96274),e.i(96274),e.i(15914),e.s(["fromSSO",0,f,"isSsoProfile",0,o,"validateSsoProfile",0,g],19961)},49465,e=>{e.v(r=>Promise.all(["server/chunks/03239_79c83117._.js","server/chunks/03239_@aws-sdk_nested-clients_dist-es_submodules_sso-oidc_index_6687fe05.js","server/chunks/03239_f42fc8d8._.js"].map(r=>e.l(r))).then(()=>r(95469)))},95003,e=>{e.v(r=>Promise.all(["server/chunks/03239_@smithy_core_dist-es_util-identity-and-auth_httpAuthSchemes_noAuth_b9e87464.js","server/chunks/03239_@aws-sdk_a6b00bb9._.js","server/chunks/03239_f42fc8d8._.js"].map(r=>e.l(r))).then(()=>r(18120)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__212e2bc7._.js.map