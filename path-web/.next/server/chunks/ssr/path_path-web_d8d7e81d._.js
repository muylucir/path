module.exports=[94814,(a,b,c)=>{"use strict";b.exports=a.r(39679).vendored["react-ssr"].ReactDOM},54988,a=>{"use strict";let b=(0,a.i(815).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],54988)},41892,a=>{"use strict";var b=a.i(89400),c=a.i(43565);function d({className:a,type:d,...e}){return(0,b.jsx)("input",{type:d,"data-slot":"input",className:(0,c.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...e})}a.s(["Input",()=>d])},19688,a=>{"use strict";var b=a.i(89400),c=a.i(21047),d=a.i(47241),e=a.i(4939),f=a.i(41892),g=a.i(99697),h=a.i(54988);function i({formData:a,onComplete:d}){let[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1),s=(0,c.useRef)(null);(0,c.useEffect)(()=>{t()},[]),(0,c.useEffect)(()=>{s.current?.scrollIntoView({behavior:"smooth"})},[i,k]);let t=async()=>{p(!0);let b="";try{let c=await fetch("/api/bedrock/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),d=c.body?.getReader(),e=new TextDecoder;if(d)for(;;){let{done:a,value:c}=await d.read();if(a)break;for(let a of e.decode(c).split("\n"))if(a.startsWith("data: ")){let c=a.slice(6);if("[DONE]"===c){let a={role:"assistant",content:b};j(b=>[...b,a]),l(""),p(!1);return}try{let a=JSON.parse(c);b+=a.text,l(b)}catch(a){}}}}catch(a){console.error("Error:",a),p(!1)}},u=async()=>{if(!m.trim()||o)return;let a=m.trim();if(n(""),a.includes("분석 완료")||a.includes("완료"))return void await v([...i,{role:"user",content:a}]);let b=[...i,{role:"user",content:a}];j(b),p(!0);let c="";try{let d=await fetch("/api/bedrock/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({conversation:b,userMessage:a})}),e=d.body?.getReader(),f=new TextDecoder;if(e)for(;;){let{done:a,value:b}=await e.read();if(a)break;for(let a of f.decode(b).split("\n"))if(a.startsWith("data: ")){let b=a.slice(6);if("[DONE]"===b){let a={role:"assistant",content:c};j(b=>[...b,a]),l(""),p(!1);return}try{let a=JSON.parse(b);c+=a.text,l(c)}catch(a){}}}}catch(a){console.error("Error:",a),p(!1)}},v=async a=>{r(!0);try{let b=await fetch("/api/bedrock/finalize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({conversation:a})}),c=await b.json();d(a,c)}catch(a){console.error("Error:",a),r(!1)}};return(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"2️⃣ Claude 분석 및 보완"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:'Claude가 분석하고 추가 질문을 합니다. 답변하거나 "분석 완료"를 입력하세요.'})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"border rounded-lg p-4 min-h-[400px] max-h-[600px] overflow-y-auto space-y-4",children:[i.map((a,c)=>(0,b.jsx)("div",{className:`flex ${"user"===a.role?"justify-end":"justify-start"}`,children:(0,b.jsxs)("div",{className:`max-w-[80%] rounded-lg p-3 ${"user"===a.role?"bg-primary text-primary-foreground":"bg-muted"}`,children:[(0,b.jsx)("div",{className:"text-xs font-semibold mb-1",children:"user"===a.role?"You":"Claude"}),(0,b.jsx)("div",{className:"text-sm whitespace-pre-wrap",children:a.content})]})},c)),k&&(0,b.jsx)("div",{className:"flex justify-start",children:(0,b.jsxs)("div",{className:"max-w-[80%] rounded-lg p-3 bg-muted",children:[(0,b.jsx)("div",{className:"text-xs font-semibold mb-1",children:"Claude"}),(0,b.jsxs)("div",{className:"text-sm whitespace-pre-wrap",children:[k,(0,b.jsx)("span",{className:"inline-block w-2 h-4 bg-foreground animate-pulse ml-1"})]})]})}),(0,b.jsx)("div",{ref:s})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Input,{value:m,onChange:a=>n(a.target.value),onKeyDown:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),u())},placeholder:"답변을 입력하거나 '분석 완료'를 입력하세요...",disabled:o||q}),(0,b.jsx)(e.Button,{onClick:u,disabled:o||q||!m.trim(),children:o?(0,b.jsx)(h.Loader2,{className:"h-4 w-4 animate-spin"}):"전송"})]}),(0,b.jsx)(e.Button,{onClick:()=>v(i),disabled:o||q||0===i.length,variant:"outline",className:"w-full",children:q?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Loader2,{className:"h-4 w-4 animate-spin mr-2"}),"최종 분석 중..."]}):"✅ 분석 완료"})]})})]})})}var j=a.i(6704);function k(){let a=(0,d.useRouter)(),[e,f]=(0,c.useState)(null);return((0,c.useEffect)(()=>{let b=sessionStorage.getItem("formData");b?f(JSON.parse(b)):a.push("/")},[a]),e)?(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsx)(j.Sidebar,{}),(0,b.jsx)("div",{className:"flex-1 max-w-4xl",children:(0,b.jsx)(i,{formData:e,onComplete:(b,c)=>{sessionStorage.setItem("chatHistory",JSON.stringify(b)),sessionStorage.setItem("analysis",JSON.stringify(c)),a.push("/results")}})})]}):(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("div",{className:"text-lg",children:"로딩 중..."})})})}a.s(["default",()=>k],19688)}];

//# sourceMappingURL=path_path-web_d8d7e81d._.js.map