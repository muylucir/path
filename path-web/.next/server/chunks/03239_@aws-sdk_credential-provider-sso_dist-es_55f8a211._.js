module.exports=[19961,e=>{"use strict";e.s([],33574),e.i(33574);var r=e.i(7401),o=e.i(49871),i=e.i(81752),s=e.i(98854);let t=e=>e&&("string"==typeof e.sso_start_url||"string"==typeof e.sso_account_id||"string"==typeof e.sso_session||"string"==typeof e.sso_region||"string"==typeof e.sso_role_name);e.s(["isSsoProfile",0,t],94047);var n=e.i(80849),l=e.i(73253),a=e.i(95671);let g=async({ssoStartUrl:o,ssoSession:i,ssoAccountId:s,ssoRegion:t,ssoRoleName:g,ssoClient:f,clientConfig:d,parentClientConfig:c,callerClientConfig:h,profile:p,filepath:w,configFilepath:C,ignoreCache:S,logger:u})=>{let _,m,v="To refresh this SSO session run aws sso login with the corresponding profile.";if(i)try{let e=await (0,l.fromSso)({profile:p,filepath:w,configFilepath:C,ignoreCache:S})();_={accessToken:e.token,expiresAt:new Date(e.expiration).toISOString()}}catch(e){throw new r.CredentialsProviderError(e.message,{tryNextLink:!1,logger:u})}else try{_=await (0,a.getSSOTokenFromFile)(o)}catch(e){throw new r.CredentialsProviderError(`The SSO session associated with this profile is invalid. ${v}`,{tryNextLink:!1,logger:u})}if(new Date(_.expiresAt).getTime()-Date.now()<=0)throw new r.CredentialsProviderError(`The SSO session associated with this profile has expired. ${v}`,{tryNextLink:!1,logger:u});let{accessToken:y}=_,{SSOClient:P,GetRoleCredentialsCommand:O}=await e.A(95003),k=f||new P(Object.assign({},d??{},{logger:d?.logger??h?.logger??c?.logger,region:d?.region??t,userAgentAppId:d?.userAgentAppId??h?.userAgentAppId??c?.userAgentAppId}));try{m=await k.send(new O({accountId:s,roleName:g,accessToken:y}))}catch(e){throw new r.CredentialsProviderError(e,{tryNextLink:!1,logger:u})}let{roleCredentials:{accessKeyId:A,secretAccessKey:E,sessionToken:x,expiration:N,credentialScope:L,accountId:I}={}}=m;if(!A||!E||!x||!N)throw new r.CredentialsProviderError("SSO returns an invalid temporary credential.",{tryNextLink:!1,logger:u});let F={accessKeyId:A,secretAccessKey:E,sessionToken:x,expiration:new Date(N),...L&&{credentialScope:L},...I&&{accountId:I}};return i?(0,n.setCredentialFeature)(F,"CREDENTIALS_SSO","s"):(0,n.setCredentialFeature)(F,"CREDENTIALS_SSO_LEGACY","u"),F},f=(e,o)=>{let{sso_start_url:i,sso_account_id:s,sso_region:t,sso_role_name:n}=e;if(!i||!s||!t||!n)throw new r.CredentialsProviderError(`Profile is configured with invalid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Got ${Object.keys(e).join(", ")}
Reference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html`,{tryNextLink:!1,logger:o});return e};e.s(["validateSsoProfile",0,f],15914);let d=(e={})=>async({callerClientConfig:n}={})=>{e.logger?.debug("@aws-sdk/credential-provider-sso - fromSSO");let{ssoStartUrl:l,ssoAccountId:a,ssoRegion:d,ssoRoleName:c,ssoSession:h}=e,{ssoClient:p}=e,w=(0,o.getProfileName)({profile:e.profile??n?.profile});if(l||a||d||c||h)if(l&&a&&d&&c)return g({ssoStartUrl:l,ssoSession:h,ssoAccountId:a,ssoRegion:d,ssoRoleName:c,ssoClient:p,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,callerClientConfig:e.callerClientConfig,profile:w,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger});else throw new r.CredentialsProviderError('Incomplete configuration. The fromSSO() argument hash must include "ssoStartUrl", "ssoAccountId", "ssoRegion", "ssoRoleName"',{tryNextLink:!1,logger:e.logger});{let o=(await (0,s.parseKnownFiles)(e))[w];if(!o)throw new r.CredentialsProviderError(`Profile ${w} was not found.`,{logger:e.logger});if(!t(o))throw new r.CredentialsProviderError(`Profile ${w} is not configured with SSO credentials.`,{logger:e.logger});if(o?.sso_session){let s=(await (0,i.loadSsoSessionData)(e))[o.sso_session],t=` configurations in profile ${w} and sso-session ${o.sso_session}`;if(d&&d!==s.sso_region)throw new r.CredentialsProviderError("Conflicting SSO region"+t,{tryNextLink:!1,logger:e.logger});if(l&&l!==s.sso_start_url)throw new r.CredentialsProviderError("Conflicting SSO start_url"+t,{tryNextLink:!1,logger:e.logger});o.sso_region=s.sso_region,o.sso_start_url=s.sso_start_url}let{sso_start_url:n,sso_account_id:a,sso_region:c,sso_role_name:h,sso_session:C}=f(o,e.logger);return g({ssoStartUrl:n,ssoSession:C,ssoAccountId:a,ssoRegion:c,ssoRoleName:h,ssoClient:p,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,callerClientConfig:e.callerClientConfig,profile:w,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger})}};e.s(["fromSSO",0,d],96265),e.i(96265),e.i(94047),e.s([],96274),e.i(96274),e.i(15914),e.s(["fromSSO",0,d,"isSsoProfile",0,t,"validateSsoProfile",0,f],19961)},95003,e=>{e.v(r=>Promise.all(["server/chunks/[root-of-the-server]__5bd4dad1._.js","server/chunks/03239_@aws-sdk_a6b00bb9._.js"].map(r=>e.l(r))).then(()=>r(18120)))}];

//# sourceMappingURL=03239_%40aws-sdk_credential-provider-sso_dist-es_55f8a211._.js.map