{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///home/ec2-user/project/path/path-web/lib/aws/bedrock.ts"],"sourcesContent":["import {\n  BedrockRuntimeClient,\n  InvokeModelCommand,\n  InvokeModelWithResponseStreamCommand,\n} from \"@aws-sdk/client-bedrock-runtime\";\n\nconst client = new BedrockRuntimeClient({\n  region: process.env.AWS_REGION || \"us-east-1\",\n});\n\nconst MODEL_ID = \"global.anthropic.claude-sonnet-4-5-20250929-v1:0\";\n\nexport interface BedrockMessage {\n  role: \"user\" | \"assistant\";\n  content: string;\n}\n\nexport async function invokeClaude(\n  prompt: string,\n  systemPrompt?: string\n): Promise<string> {\n  const messages = [{ role: \"user\", content: prompt }];\n\n  const body: any = {\n    anthropic_version: \"bedrock-2023-05-31\",\n    max_tokens: 16000,\n    messages,\n    temperature: 0.5,\n  };\n\n  if (systemPrompt) {\n    body.system = systemPrompt;\n  }\n\n  const command = new InvokeModelCommand({\n    modelId: MODEL_ID,\n    body: JSON.stringify(body),\n  });\n\n  const response = await client.send(command);\n  const result = JSON.parse(new TextDecoder().decode(response.body));\n  return result.content[0].text;\n}\n\nexport async function* invokeClaudeStream(\n  prompt: string,\n  systemPrompt?: string\n): AsyncGenerator<string> {\n  const messages = [{ role: \"user\", content: prompt }];\n\n  const body: any = {\n    anthropic_version: \"bedrock-2023-05-31\",\n    max_tokens: 16000,\n    messages,\n    temperature: 0.5,\n  };\n\n  if (systemPrompt) {\n    body.system = systemPrompt;\n  }\n\n  const command = new InvokeModelWithResponseStreamCommand({\n    modelId: MODEL_ID,\n    body: JSON.stringify(body),\n  });\n\n  const response = await client.send(command);\n\n  if (response.body) {\n    for await (const event of response.body) {\n      if (event.chunk?.bytes) {\n        const chunk = JSON.parse(new TextDecoder().decode(event.chunk.bytes));\n        if (chunk.type === \"content_block_delta\") {\n          if (chunk.delta?.text) {\n            yield chunk.delta.text;\n          }\n        }\n      }\n    }\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAAA;;AAMA,MAAM,SAAS,IAAI,mQAAoB,CAAC;IACtC,QAAQ,QAAQ,GAAG,CAAC,UAAU,IAAI;AACpC;AAEA,MAAM,WAAW;AAOV,eAAe,aACpB,MAAc,EACd,YAAqB;IAErB,MAAM,WAAW;QAAC;YAAE,MAAM;YAAQ,SAAS;QAAO;KAAE;IAEpD,MAAM,OAAY;QAChB,mBAAmB;QACnB,YAAY;QACZ;QACA,aAAa;IACf;IAEA,IAAI,cAAc;QAChB,KAAK,MAAM,GAAG;IAChB;IAEA,MAAM,UAAU,IAAI,2QAAkB,CAAC;QACrC,SAAS;QACT,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,MAAM,WAAW,MAAM,OAAO,IAAI,CAAC;IACnC,MAAM,SAAS,KAAK,KAAK,CAAC,IAAI,cAAc,MAAM,CAAC,SAAS,IAAI;IAChE,OAAO,OAAO,OAAO,CAAC,EAAE,CAAC,IAAI;AAC/B;AAEO,gBAAgB,mBACrB,MAAc,EACd,YAAqB;IAErB,MAAM,WAAW;QAAC;YAAE,MAAM;YAAQ,SAAS;QAAO;KAAE;IAEpD,MAAM,OAAY;QAChB,mBAAmB;QACnB,YAAY;QACZ;QACA,aAAa;IACf;IAEA,IAAI,cAAc;QAChB,KAAK,MAAM,GAAG;IAChB;IAEA,MAAM,UAAU,IAAI,+SAAoC,CAAC;QACvD,SAAS;QACT,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,MAAM,WAAW,MAAM,OAAO,IAAI,CAAC;IAEnC,IAAI,SAAS,IAAI,EAAE;QACjB,WAAW,MAAM,SAAS,SAAS,IAAI,CAAE;YACvC,IAAI,MAAM,KAAK,EAAE,OAAO;gBACtB,MAAM,QAAQ,KAAK,KAAK,CAAC,IAAI,cAAc,MAAM,CAAC,MAAM,KAAK,CAAC,KAAK;gBACnE,IAAI,MAAM,IAAI,KAAK,uBAAuB;oBACxC,IAAI,MAAM,KAAK,EAAE,MAAM;wBACrB,MAAM,MAAM,KAAK,CAAC,IAAI;oBACxB;gBACF;YACF;QACF;IACF;AACF"}},
    {"offset": {"line": 182, "column": 0}, "map": {"version":3,"sources":["file:///home/ec2-user/project/path/path-web/lib/prompts.ts"],"sourcesContent":["export const SYSTEM_PROMPT = `ë‹¹ì‹ ì€ 20ë…„ì°¨ ì†Œí”„íŠ¸ì›¨ì–´ ì•„í‚¤í…íŠ¸ì´ì AI Agent ì „ë¬¸ê°€ ê·¸ë¦¬ê³  P.A.T.H (Problem-Agent-Technical-Handoff) í”„ë ˆì„ì›Œí¬ë¥¼ ê°œë°œí•œ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.\n\n# P.A.T.H í”„ë ˆì„ì›Œí¬ë€?\n\nAI Agent ì•„ì´ë””ì–´ë¥¼ **\"ë§Œë“¤ ê°€ì¹˜ê°€ ìˆëŠ”ì§€\"** ë¹ ë¥´ê²Œ ê²€ì¦í•˜ê³ , **ì‘ë™í•˜ëŠ” í”„ë¡œí† íƒ€ì…**ê¹Œì§€ ê°€ëŠ” êµ¬ì¡°í™”ëœ ë°©ë²•ë¡ ì…ë‹ˆë‹¤.\n\n## Phase 1: PROBLEM Decomposition (ë¬¸ì œ ë¶„í•´)\n\nPain Pointë¥¼ 4ê°€ì§€ ìš”ì†Œë¡œ ë¶„í•´:\n\n### 1. INPUT (íŠ¸ë¦¬ê±°)\n- **Event-Driven (ì´ë²¤íŠ¸)**: ì™¸ë¶€ ì‹œìŠ¤í…œ ì´ë²¤íŠ¸ ë°œìƒ ì‹œ\n- **Scheduled (ìŠ¤ì¼€ì¤„)**: ì •í•´ì§„ ì‹œê°„ì— ìë™ ì‹¤í–‰\n- **On-Demand (ìš”ì²­)**: ì‚¬ìš©ìê°€ ì§ì ‘ ì‹¤í–‰\n- **Streaming (ìŠ¤íŠ¸ë¦¬ë°)**: ì‹¤ì‹œê°„ ë°ì´í„° ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬\n- **Conditional (ì¡°ê±´ë¶€)**: íŠ¹ì • ì¡°ê±´/ì„ê³„ê°’ ì¶©ì¡± ì‹œ\n\n### 2. PROCESS (ì‘ì—… ë‹¨ê³„)\n- **ë°ì´í„° ìˆ˜ì§‘**: ì—¬ëŸ¬ ì†ŒìŠ¤ì—ì„œ ì •ë³´ ì¡°íšŒ\n- **ë¶„ì„/ë¶„ë¥˜**: íŒ¨í„´ ì¸ì‹, ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜, ì´ìƒ íƒì§€\n- **íŒë‹¨/í‰ê°€**: ê·œì¹™ ê¸°ë°˜ ì˜ì‚¬ê²°ì •, ì ìˆ˜ ì‚°ì •, ìš°ì„ ìˆœìœ„ ê²°ì •\n- **ì½˜í…ì¸  ìƒì„±**: ë¬¸ì„œ, ì´ë©”ì¼, ì½”ë“œ, ë³´ê³ ì„œ ì‘ì„±\n- **ê²€ì¦/ê°œì„ **: í’ˆì§ˆ í™•ì¸, ì˜¤ë¥˜ ìˆ˜ì •, ë°˜ë³µ ê°œì„ \n- **ì‹¤í–‰/ì—°ë™**: API í˜¸ì¶œ, DB ì—…ë°ì´íŠ¸, ì•Œë¦¼ ì „ì†¡\n\n### 3. OUTPUT (ê²°ê³¼ë¬¼)\n- **Decision (ì˜ì‚¬ê²°ì •)**: ìŠ¹ì¸/ê±°ì ˆ, ë¶„ë¥˜, ì ìˆ˜, ìš°ì„ ìˆœìœ„\n- **Content (ì½˜í…ì¸ )**: ë¬¸ì„œ, ì´ë©”ì¼, ë³´ê³ ì„œ, ì½”ë“œ, ì œì•ˆì„œ\n- **Notification (ì•Œë¦¼)**: ì´ë©”ì¼, Slack, SMS, ëŒ€ì‹œë³´ë“œ ì•Œë¦¼\n- **Action (ì•¡ì…˜)**: í‹°ì¼“ ìƒì„±, API í˜¸ì¶œ, ì›Œí¬í”Œë¡œìš° íŠ¸ë¦¬ê±°, DB ì—…ë°ì´íŠ¸\n- **Insight (ì¸ì‚¬ì´íŠ¸)**: ë¶„ì„ ê²°ê³¼, ì¶”ì²œ, ì˜ˆì¸¡, íŠ¸ë Œë“œ\n\n### 4. HUMAN-IN-LOOP (ì‚¬ëŒ ê°œì… ì‹œì )\n- **None**: ì™„ì „ ìë™\n- **Review**: ì‹¤í–‰ ì „ ìŠ¹ì¸ í•„ìš”\n- **Exception**: ë¶ˆí™•ì‹¤í•  ë•Œë§Œ ê°œì…\n- **Collaborate**: AIì™€ ì‚¬ëŒì´ í•¨ê»˜ ì‘ì—…\n\n## Phase 2: AGENT Pattern Mapping (íŒ¨í„´ ì„ íƒ)\n\nAndrew Ngì˜ Agentic Design Patterns ê¸°ë°˜ 4ê°€ì§€ íŒ¨í„´:\n\n### Pattern 1: Reflection (ë°˜ì„±)\n- **ì–¸ì œ**: OUTPUT í’ˆì§ˆ ê²€ì¦ í›„ ìê°€ ê°œì„  í•„ìš”\n- **ì˜ˆì‹œ**: ì½”ë“œ ìƒì„±, ì œì•ˆì„œ ì‘ì„±, SQL ìµœì í™”\n\n### Pattern 2: Tool Use (ë„êµ¬ ì‚¬ìš©)\n- **ì–¸ì œ**: ì™¸ë¶€ ë„êµ¬/API í˜¸ì¶œì´ í•„ìš”í•œ ë‹¨ìˆœ ì‘ì—…\n- **ì˜ˆì‹œ**: ê³„ì‚°ê¸° ì‚¬ìš©, ì›¹ ê²€ìƒ‰, DB ì¡°íšŒ, API í˜¸ì¶œ\n\n### Pattern 3: Planning (ê³„íš)\n- **ì–¸ì œ**: ë³µì¡í•œ ì‘ì—…ì„ ë‹¨ê³„ë³„ë¡œ ë¶„í•´í•˜ì—¬ ìˆœì°¨ ì‹¤í–‰\n- **ì˜ˆì‹œ**: ì—¬í–‰ ê³„íš, ì—°êµ¬ ë³´ê³ ì„œ ì‘ì„±, í”„ë¡œì íŠ¸ ê´€ë¦¬\n\n### Pattern 4: Multi-Agent (ë‹¤ì¤‘ ì—ì´ì „íŠ¸)\n- **ì–¸ì œ**: ì—¬ëŸ¬ ì „ë¬¸ ì—ì´ì „íŠ¸ê°€ í˜‘ì—…í•˜ê±°ë‚˜ ë³‘ë ¬ ì‘ì—…\n- **ì˜ˆì‹œ**: ì‹œì¥ ì¡°ì‚¬, ì½”ë“œ ë¦¬ë·°, ë‹¤êµ­ì–´ ë²ˆì—­ ê²€ì¦\n\n## Phase 3: Feasibility Check (ì‹¤í˜„ ê°€ëŠ¥ì„± í‰ê°€)\n\n5ê°œ í•­ëª©ì„ í‰ê°€í•˜ì—¬ ì´ 50ì  ë§Œì ìœ¼ë¡œ ì‚°ì •:\n\n### 1. ë°ì´í„° ì ‘ê·¼ì„± (10ì )\n- **10ì **: MCP ì„œë²„ ì¡´ì¬\n- **9ì **: API ì¡´ì¬\n- **7ì **: íŒŒì¼ ê¸°ë°˜\n- **6ì **: DB ì§ì ‘ ì ‘ê·¼\n- **3ì **: í™”ë©´ ìŠ¤í¬ë˜í•‘\n- **0ì **: ì˜¤í”„ë¼ì¸ë§Œ ì¡´ì¬\n\n### 2. íŒë‹¨ ê¸°ì¤€ ëª…í™•ì„± (10ì )\n- **10ì **: ëª…í™•í•œ if-then ê·œì¹™ìœ¼ë¡œ í‘œí˜„ ê°€ëŠ¥\n- **8ì **: 100+ ë ˆì´ë¸”ë§ëœ ì˜ˆì‹œ ì¡´ì¬\n- **6ì **: ì•”ë¬µì  íŒ¨í„´ ìˆìœ¼ë‚˜ ë¬¸ì„œí™” ì•ˆë¨\n- **4ì **: ì „ë¬¸ê°€ ì§ê°ì— ì˜ì¡´\n- **2ì **: \"ê·¸ëƒ¥ ì•Œ ìˆ˜ ìˆì–´ìš”\" (ì„¤ëª… ë¶ˆê°€)\n\n### 3. ì˜¤ë¥˜ í—ˆìš©ë„ (10ì )\n- **10ì **: í‹€ë ¤ë„ ê´œì°®ìŒ\n- **8ì **: ë¦¬ë·° í›„ ì‹¤í–‰\n- **5ì **: 90%+ ì •í™•ë„ í•„ìš”\n- **3ì **: 99%+ ì •í™•ë„ í•„ìš”\n- **0ì **: ë¬´ì¡°ê±´ 100%\n\n### 4. ì§€ì—° ìš”êµ¬ì‚¬í•­ (10ì )\n- **10ì **: ëª‡ ì‹œê°„ OK\n- **9ì **: ëª‡ ë¶„ OK\n- **7ì **: 1ë¶„ ì´ë‚´\n- **5ì **: 10ì´ˆ ì´ë‚´\n- **3ì **: ì‹¤ì‹œê°„ <3ì´ˆ\n\n### 5. í†µí•© ë³µì¡ë„ (10ì )\n- **10ì **: ë…ë¦½ ì‹¤í–‰\n- **8ì **: 1-2ê°œ ì‹œìŠ¤í…œ\n- **5ì **: 3-5ê°œ ì‹œìŠ¤í…œ\n- **3ì **: ë ˆê±°ì‹œ ì‹œìŠ¤í…œ\n- **1ì **: ì»¤ìŠ¤í…€ í”„ë¡œí† ì½œ\n\n### íŒì • ê¸°ì¤€\n- **40-50ì **: âœ… ì¦‰ì‹œ í”„ë¡œí† íƒ€ì… ì‹œì‘\n- **30-40ì **: âš ï¸ ì¡°ê±´ë¶€ ì§„í–‰\n- **20-30ì **: ğŸ”„ ë°ì´í„°/í”„ë¡œì„¸ìŠ¤ ê°œì„  í›„ ì¬í‰ê°€\n- **20ì  ë¯¸ë§Œ**: âŒ ëŒ€ì•ˆ ëª¨ìƒ‰\n\n## ë‹¹ì‹ ì˜ ì—­í• \n\n1. **ë¶„ì„**: ì‚¬ìš©ì ì…ë ¥ì„ ë¶„ì„í•˜ì—¬ PROCESS ë‹¨ê³„ë¥¼ ì¶”ë¡ í•˜ê³  êµ¬ì¡°í™”\n2. **ì¶”ì²œ**: 4ê°€ì§€ íŒ¨í„´ ì¤‘ ê°€ì¥ ì í•©í•œ ê²ƒì„ ì„ íƒí•˜ê³  ëª…í™•í•œ ì´ìœ  ì œì‹œ\n3. **ì§ˆë¬¸**: ë¶€ì¡±í•œ ì •ë³´ëŠ” êµ¬ì²´ì ì´ê³  ì‹¤ìš©ì ì¸ ì§ˆë¬¸ìœ¼ë¡œ ë³´ì™„ (ìµœëŒ€ 3ê°œ, í•µì‹¬ë§Œ)\n4. **í‰ê°€**: Feasibility ì ìˆ˜ë¥¼ ê° í•­ëª©ë³„ ê·¼ê±°ì™€ í•¨ê»˜ ì‚°ì •\n5. **íŒë‹¨**: í”„ë¡œí† íƒ€ì… ì„±ê³µ ê°€ëŠ¥ì„±, ë¦¬ìŠ¤í¬, ë‹¤ìŒ ë‹¨ê³„ë¥¼ ëª…í™•íˆ ì œì‹œ\n\n**ì¤‘ìš”: ì´ê²ƒì€ í”„ë¡œí† íƒ€ì… ê²€ì¦ì´ë¯€ë¡œ ì™„ë²½í•œ ì •ë³´ë³´ë‹¤ëŠ” ë¹ ë¥¸ ì˜ì‚¬ê²°ì •ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.**\n**ì¶”ê°€ ì§ˆë¬¸ì€ ì •ë§ í•„ìˆ˜ì ì¸ ê²ƒë§Œ ìµœëŒ€ 3ê°œê¹Œì§€ë§Œ í•˜ì„¸ìš”.**\n**3í„´ ì´ìƒ ëŒ€í™”ê°€ ê¸¸ì–´ì§€ë©´ í˜„ì¬ ì •ë³´ë¡œ ë¶„ì„ì„ ì§„í–‰í•˜ì„¸ìš”.**\n\n**ëŒ€í™” ìŠ¤íƒ€ì¼:**\n- ì¹œì ˆí•˜ê³  ì „ë¬¸ì ìœ¼ë¡œ\n- ì‹¤ë¬´ì—ì„œ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ë¶„ì„ ì œê³µ\n- ë‚™ê´€ì ì´ì§€ ì•Šê³  í˜„ì‹¤ì ìœ¼ë¡œ í‰ê°€\n- ë¦¬ìŠ¤í¬ë¥¼ ìˆ¨ê¸°ì§€ ì•Šê³  ëª…í™•íˆ ì œì‹œ`;\n\nexport function getInitialAnalysisPrompt(formData: {\n  painPoint: string;\n  inputType: string;\n  processSteps: string[];\n  outputTypes: string[];\n  humanLoop: string;\n  dataSources: Array<{ type: string; description: string }>;\n  errorTolerance: string;\n  additionalContext?: string;\n}): string {\n  const dataSourceStr = formData.dataSources\n    .filter((ds) => ds.type && ds.description)\n    .map((ds) => `- ${ds.type}: ${ds.description}`)\n    .join(\"\\n\");\n\n  return `ë‹¤ìŒ AI Agent ì•„ì´ë””ì–´ë¥¼ P.A.T.H í”„ë ˆì„ì›Œí¬ë¡œ ë¶„ì„í•˜ì„¸ìš”:\n\n**Pain Point**: ${formData.painPoint}\n**INPUT Type**: ${formData.inputType}\n**PROCESS Steps**: ${formData.processSteps.join(\", \")}\n**OUTPUT Types**: ${formData.outputTypes.join(\", \")}\n**HUMAN-IN-LOOP**: ${formData.humanLoop}\n**Data Sources**:\n${dataSourceStr || \"ë¯¸ì§€ì •\"}\n**Error Tolerance**: ${formData.errorTolerance}\n**Additional Context**: ${formData.additionalContext || \"ì—†ìŒ\"}\n\në‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•˜ì„¸ìš”:\n\n1. ì…ë ¥ ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬ PROCESS ë‹¨ê³„ë¥¼ ìƒì„¸í™”\n2. ê°€ì¥ ì í•©í•œ íŒ¨í„´ ì¶”ì²œ (Reflection/Tool Use/Planning/Multi-Agent) í•„ìš”í•˜ë‹¤ë©´ íŒ¨í„´ì„ ì¡°í•©í•´ë„ë¨. ex)Planning+Tool Use\n3. ì¶”ê°€ë¡œ í•„ìš”í•œ ì •ë³´ê°€ ìˆë‹¤ë©´ 3-5ê°œ ì§ˆë¬¸ ìƒì„±\n4. í˜„ì¬ ì •ë³´ë§Œìœ¼ë¡œ Feasibility ì˜ˆë¹„ í‰ê°€ (0-50ì )\n\në‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ì‘ë‹µ:\n\n## ğŸ“Š ì´ˆê¸° ë¶„ì„\n\n**ì¶”ë¡ ëœ PROCESS ë‹¨ê³„:**\n- [ë‹¨ê³„ë“¤]\n\n**ì¶”ì²œ íŒ¨í„´:** [íŒ¨í„´ëª…]\n**ì´ìœ :** [ì„¤ëª…]\n\n**ì˜ˆë¹„ Feasibility:** [ì ìˆ˜]/50\n- ë°ì´í„° ì ‘ê·¼ì„±: [ì ìˆ˜]/10\n- íŒë‹¨ ëª…í™•ì„±: [ì ìˆ˜]/10\n- ì˜¤ë¥˜ í—ˆìš©ë„: [ì ìˆ˜]/10\n- ì§€ì—° ìš”êµ¬ì‚¬í•­: [ì ìˆ˜]/10\n- í†µí•© ë³µì¡ë„: [ì ìˆ˜]/10\n\n## â“ ì¶”ê°€ ì§ˆë¬¸\n\në” ì •í™•í•œ ë¶„ì„ì„ ìœ„í•´ ë‹¤ìŒì„ ì•Œë ¤ì£¼ì„¸ìš”:\n1. [ì§ˆë¬¸1]\n2. [ì§ˆë¬¸2]\n3. [ì§ˆë¬¸3]\n\në‹µë³€í•˜ì‹œë©´ ìµœì¢… ë¶„ì„ì„ ì§„í–‰í•©ë‹ˆë‹¤. ë˜ëŠ” \"ë¶„ì„ ì™„ë£Œ\"ë¥¼ ì…ë ¥í•˜ë©´ í˜„ì¬ ì •ë³´ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.`;\n}\n"],"names":[],"mappings":";;;;;;AAAO,MAAM,gBAAgB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oBAwHV,CAAC;AAEd,SAAS,yBAAyB,QASxC;IACC,MAAM,gBAAgB,SAAS,WAAW,CACvC,MAAM,CAAC,CAAC,KAAO,GAAG,IAAI,IAAI,GAAG,WAAW,EACxC,GAAG,CAAC,CAAC,KAAO,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,EAAE,EAAE,GAAG,WAAW,EAAE,EAC7C,IAAI,CAAC;IAER,OAAO,CAAC;;gBAEM,EAAE,SAAS,SAAS,CAAC;gBACrB,EAAE,SAAS,SAAS,CAAC;mBAClB,EAAE,SAAS,YAAY,CAAC,IAAI,CAAC,MAAM;kBACpC,EAAE,SAAS,WAAW,CAAC,IAAI,CAAC,MAAM;mBACjC,EAAE,SAAS,SAAS,CAAC;;AAExC,EAAE,iBAAiB,MAAM;qBACJ,EAAE,SAAS,cAAc,CAAC;wBACvB,EAAE,SAAS,iBAAiB,IAAI,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kDAiCX,CAAC;AACnD"}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":["file:///home/ec2-user/project/path/path-web/app/api/bedrock/finalize/route.ts"],"sourcesContent":["import { invokeClaude } from \"@/lib/aws/bedrock\";\nimport { SYSTEM_PROMPT } from \"@/lib/prompts\";\nimport { NextRequest } from \"next/server\";\n\nexport async function POST(req: NextRequest) {\n  try {\n    const { conversation } = await req.json();\n\n    // Build conversation context\n    const conversationText = conversation\n      .map((msg: { role: string; content: string }) => \n        `${msg.role.toUpperCase()}: ${msg.content}`\n      )\n      .join(\"\\n\\n\");\n\n    const prompt = `ë‹¤ìŒì€ ì§€ê¸ˆê¹Œì§€ì˜ ë¶„ì„ ë‚´ìš©ì…ë‹ˆë‹¤:\n\n${conversationText}\n\nì´ì œ ìµœì¢… ë¶„ì„ì„ ìˆ˜í–‰í•˜ì„¸ìš”. ë‹¤ìŒì„ JSON í˜•ì‹ìœ¼ë¡œ ì¶œë ¥:\n\n{\n  \"pain_point\": \"ì‚¬ìš©ì Pain Point\",\n  \"input_type\": \"INPUT íƒ€ì…\",\n  \"input_detail\": \"INPUT ìƒì„¸\",\n  \"process_steps\": [\"ë‹¨ê³„1: ì„¤ëª…\", \"ë‹¨ê³„2: ì„¤ëª…\", \"...\"],\n  \"output_types\": [\"OUTPUT íƒ€ì…1\", \"OUTPUT íƒ€ì…2\"],\n  \"output_detail\": \"OUTPUT ìƒì„¸\",\n  \"human_loop\": \"None/Review/Exception/Collaborate\",\n  \"pattern\": \"Reflection/Tool Use/Planning/Multi-Agent\",\n  \"pattern_reason\": \"íŒ¨í„´ ì„ íƒ ì´ìœ \",\n  \"feasibility_breakdown\": {\n    \"data_access\": 0-10,\n    \"decision_clarity\": 0-10,\n    \"error_tolerance\": 0-10,\n    \"latency\": 0-10,\n    \"integration\": 0-10\n  },\n  \"feasibility_score\": 0-50,\n  \"recommendation\": \"ì¶”ì²œ ì‚¬í•­\",\n  \"risks\": [\"ë¦¬ìŠ¤í¬1\", \"ë¦¬ìŠ¤í¬2\"],\n  \"next_steps\": [\n    \"Phase 1: í•µì‹¬ ê¸°ëŠ¥ í”„ë¡œí† íƒ€ì… - ì„¤ëª…\",\n    \"Phase 2: ê²€ì¦ ë° í…ŒìŠ¤íŠ¸ - ì„¤ëª…\",\n    \"Phase 3: (ì„ íƒì ) ê°œì„  ë° í™•ì¥ - ì„¤ëª…\"\n  ]\n}\n\nì¤‘ìš”: next_stepsëŠ” ì£¼ ë‹¨ìœ„ ê¸°ê°„ì´ ì•„ë‹Œ Phase/ë‹¨ê³„ ì¤‘ì‹¬ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”.\nJSONë§Œ ì¶œë ¥í•˜ì„¸ìš”.`;\n\n    const systemPromptForJson = `${SYSTEM_PROMPT}\n\në‹¹ì‹ ì€ ì§€ê¸ˆê¹Œì§€ì˜ ëŒ€í™”ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìµœì¢… ë¶„ì„ì„ ìˆ˜í–‰í•˜ê³  JSON í˜•ì‹ìœ¼ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤.\nê°„ê²°í•˜ê³  ì •í™•í•˜ê²Œ ì‘ì„±í•˜ì„¸ìš”.`;\n\n    const response = await invokeClaude(prompt, systemPromptForJson);\n\n    // Extract JSON from response\n    const jsonStart = response.indexOf(\"{\");\n    const jsonEnd = response.lastIndexOf(\"}\") + 1;\n\n    if (jsonStart !== -1 && jsonEnd > jsonStart) {\n      const jsonStr = response.substring(jsonStart, jsonEnd);\n      const analysis = JSON.parse(jsonStr);\n      return Response.json(analysis);\n    } else {\n      throw new Error(\"JSONì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤\");\n    }\n  } catch (error) {\n    console.error(\"Error in finalize API:\", error);\n    return new Response(\n      JSON.stringify({ error: \"ìµœì¢… ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤\" }),\n      {\n        status: 500,\n        headers: { \"Content-Type\": \"application/json\" },\n      }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,MAAM,IAAI,IAAI;QAEvC,6BAA6B;QAC7B,MAAM,mBAAmB,aACtB,GAAG,CAAC,CAAC,MACJ,GAAG,IAAI,IAAI,CAAC,WAAW,GAAG,EAAE,EAAE,IAAI,OAAO,EAAE,EAE5C,IAAI,CAAC;QAER,MAAM,SAAS,CAAC;;AAEpB,EAAE,iBAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAgCP,CAAC;QAET,MAAM,sBAAsB,GAAG,wJAAa,CAAC;;;gBAGjC,CAAC;QAEb,MAAM,WAAW,MAAM,IAAA,8JAAY,EAAC,QAAQ;QAE5C,6BAA6B;QAC7B,MAAM,YAAY,SAAS,OAAO,CAAC;QACnC,MAAM,UAAU,SAAS,WAAW,CAAC,OAAO;QAE5C,IAAI,cAAc,CAAC,KAAK,UAAU,WAAW;YAC3C,MAAM,UAAU,SAAS,SAAS,CAAC,WAAW;YAC9C,MAAM,WAAW,KAAK,KAAK,CAAC;YAC5B,OAAO,SAAS,IAAI,CAAC;QACvB,OAAO;YACL,MAAM,IAAI,MAAM;QAClB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,IAAI,SACT,KAAK,SAAS,CAAC;YAAE,OAAO;QAAqB,IAC7C;YACE,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAChD;IAEJ;AACF"}}]
}