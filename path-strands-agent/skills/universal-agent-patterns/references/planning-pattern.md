# Planning Pattern (계획 수립)

## 개념

Planning 패턴은 복잡한 작업을 하위 작업으로 분해하고 순차적으로 실행하는 방식입니다.

```
Task -> Plan (Subtasks) -> Execute Step 1 -> Execute Step 2 -> ... -> Final Result
```

## 핵심 구성 요소

### 1. Planner (계획자)
- 목표 분석
- 하위 작업 분해
- 실행 순서 결정

### 2. Executor (실행자)
- 각 하위 작업 수행
- 중간 결과 관리
- 다음 단계 준비

### 3. Monitor (감시자)
- 진행 상황 추적
- 계획 수정 필요 여부 판단
- 실패 처리

## 적합한 상황

| 상황 | 설명 |
|------|------|
| 복잡한 작업 | 여러 단계가 필요한 작업 |
| 순차적 의존성 | 이전 결과가 다음 단계에 필요 |
| 장기 작업 | 시간이 오래 걸리는 작업 |

## Agent 구성 예시

### 단일 Agent Planning

```
Planning Agent
├── Planner Component
│   └── 작업 분해 로직
├── Executor Component
│   └── 단계별 실행
└── State Management
    ├── 현재 단계
    ├── 중간 결과
    └── 계획 상태
```

### 분리된 Agent Planning

```
Planner Agent
     |
     v
[Plan: Step 1, Step 2, Step 3]
     |
     v
Executor Agent -> Step 1 -> Step 2 -> Step 3
     |                                   |
     +---------- 결과 수집 <------------+
```

## State 관리

| State 유형 | 내용 | 예시 |
|-----------|------|------|
| **Plan** | 작업 계획 | 단계 목록, 순서 |
| **Current Step** | 현재 실행 중인 단계 | Step 2/5 |
| **Step Results** | 각 단계 결과 | 중간 산출물 |
| **Dependencies** | 단계 간 의존성 | Step 3은 Step 1, 2 결과 필요 |

## 예제: 여행 계획 Agent

### System Prompt 예시

```
당신은 여행 계획 전문가입니다.

사용자의 여행 요청을 받으면:
1. 요청을 분석하여 필요한 작업을 나열하세요
2. 각 작업을 순서대로 실행하세요
3. 모든 작업이 완료되면 최종 여행 계획을 제시하세요

계획 수립 시:
- 각 단계는 명확한 목표가 있어야 합니다
- 이전 단계의 결과가 다음 단계에 어떻게 사용되는지 고려하세요
- 실패 시 대안을 준비하세요
```

### 실행 흐름 예시

```
User: "다음 주 파리 3박 4일 여행 계획해줘"

[Planning Phase]
Plan:
1. 여행 날짜 및 예산 확인
2. 항공편 검색
3. 숙소 검색
4. 주요 관광지 조사
5. 일자별 일정 작성
6. 최종 계획 정리

[Execution Phase]
[Step 1] 날짜: 다음 주 월-목, 예산: 미지정
[Step 2] 항공편: 인천-파리 직항, 왕복 80만원대
[Step 3] 숙소: 파리 중심부 호텔, 1박 15만원대
[Step 4] 관광지: 에펠탑, 루브르, 개선문, 몽마르트르
[Step 5] 일정 작성 완료
[Step 6] 최종 계획 문서화

[Final Output] 파리 3박 4일 여행 계획서
```

## 계획 유형

### 정적 계획 (Static Planning)
- 시작 전 전체 계획 수립
- 중간에 계획 변경 없음
- 예측 가능한 작업에 적합

### 동적 계획 (Dynamic Planning)
- 각 단계 완료 후 계획 재평가
- 결과에 따라 계획 수정
- 불확실한 작업에 적합

```
[Initial Plan] -> Execute Step 1 -> [Re-plan] -> Execute Step 2 -> ...
```

## 주의사항

1. **과도한 분해 방지**: 너무 세분화하면 오버헤드 증가
2. **의존성 관리**: 단계 간 의존성 명확히 정의
3. **실패 복구**: 중간 단계 실패 시 복구 전략
4. **진행 추적**: 장기 작업의 경우 진행률 표시
5. **계획 검증**: 수립된 계획의 실현 가능성 검토
