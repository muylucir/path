# 파이프라인 설계 패턴

AI-Assisted Workflow에서 사용되는 주요 파이프라인 패턴입니다.

## 1. Sequential Pipeline (순차 파이프라인)

가장 기본적인 패턴. 각 단계가 순서대로 실행됩니다.

```
[입력] → [전처리] → [AI 분류] → [처리] → [AI 요약] → [출력]
```

**적합 상황:**
- 단계 간 의존성이 명확한 경우
- 각 단계의 입출력이 1:1 매핑
- 데이터 처리, 문서 변환, 보고서 생성

**AWS 구현:**
- Step Functions: 순차 State 연결
- Lambda: 단계별 함수, SQS로 연결
- 코드: async/await 체이닝

**예시 — 고객 문의 자동 응답:**
```
이메일 수신 → 본문 추출 → [AI: 문의 분류] → 템플릿 선택 → [AI: 응답 생성] → 검토 큐 → 발송
```

## 2. Fan-out / Fan-in (분산-수집)

하나의 입력을 여러 병렬 처리 후 결과를 합산합니다.

```
            ┌→ [AI 감성분석] ─┐
[입력] → [분할] → [AI 키워드추출] → [결합] → [출력]
            └→ [AI 요약]     ─┘
```

**적합 상황:**
- 동일 데이터에 여러 AI 분석을 병렬 수행
- 처리 시간 단축이 중요한 경우
- 독립적인 분석 결과를 종합해야 하는 경우

**AWS 구현:**
- Step Functions: Parallel State
- Lambda + SQS: Fan-out 패턴
- EventBridge: 이벤트 기반 병렬 트리거

**예시 — 문서 종합 분석:**
```
문서 업로드 → [분할] → AI 요약 / AI 핵심어 / AI 감성분석 → [종합] → 분석 보고서
```

## 3. Conditional Pipeline (조건부 파이프라인)

AI 판단 결과에 따라 다른 경로를 실행합니다.

```
                    ┌→ [긴급 처리] → [즉시 알림]
[입력] → [AI 분류] ─┤→ [일반 처리] → [배치 큐]
                    └→ [스팸 필터] → [폐기]
```

**적합 상황:**
- AI 분류 결과에 따라 후속 처리가 달라지는 경우
- 우선순위 기반 라우팅
- 예외 처리 경로가 필요한 경우

**AWS 구현:**
- Step Functions: Choice State + AI 분류 결과
- EventBridge: 룰 기반 라우팅

**예시 — 티켓 자동 라우팅:**
```
티켓 접수 → [AI: 긴급도 판단] → 긴급(즉시 담당자 배정) / 보통(자동 응답 후 큐) / 스팸(폐기)
```

## 4. Event-driven Pipeline (이벤트 기반)

외부 이벤트에 의해 파이프라인이 트리거됩니다.

```
[이벤트 소스] → [EventBridge] → [전처리 Lambda] → [AI 처리] → [후처리] → [알림]
```

**적합 상황:**
- 실시간 반응이 필요한 경우
- 다양한 이벤트 소스 통합
- 느슨한 결합이 필요한 마이크로서비스 환경

**AWS 구현:**
- EventBridge + Lambda + Bedrock
- SNS/SQS 기반 비동기 처리

**예시 — 실시간 로그 분석:**
```
CloudWatch 로그 → EventBridge 룰 → [AI: 이상 탐지] → 정상(무시) / 이상(Slack 알림 + 티켓 생성)
```

## 패턴 선택 가이드

| 요구사항 | 추천 패턴 |
|---------|----------|
| 단순 순차 처리 | Sequential |
| 병렬 분석 필요 | Fan-out/Fan-in |
| AI 판단에 따른 분기 | Conditional |
| 외부 이벤트 반응 | Event-driven |
| 복잡한 조합 | Sequential + Conditional 조합 |
